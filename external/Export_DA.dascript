const mz_start = 520
const mz_end = 580
const spec_start = 1   
const spec_end = 9554
   
    
For SpecCounter = Analysis.Spectra.Count to 1 Step -1  ' deletes all previously generated spectra     
    Analysis.Spectra.Delete SpecCounter     
Next       
     
Dim fso, f, logfile, line, count        
Dim spec   
        
Set fso = CreateObject("Scripting.FileSystemObject")        
Set logfile = fso.OpenTextFile (".\SBB5-10cm_mz520-580.txt", 2, true) ' Create a file for writing
      
logfile.writeline(spec_end)        
     
for num=spec_start to spec_end   
  Analysis.Spectra.Add num, daProfileOnly       
  Analysis.Spectra(Analysis.Spectra.Count).MassListFind  mz_start, mz_end    
       
  Set spec = Analysis.spectra(1)   
  For each var in spec.Variables        
    If var.Name = "Spot Number" then        
        logfile.Write(var.Value)        
    end if        
  next        
        
  line = ""        
  count = 0        
  for each peak in spec.MSPeakList        
    if peak.m_over_z > mz_start then    ' these conditions are redundant if only peaks in range of interest are generated    
      if peak.m_over_z < mz_end then        
        count = count + 1        
        line = line&";"&peak.m_over_z&";"&peak.Intensity&";"&peak.SignaltoNoise        
      end if        
    end if        
        
  Next     
  logfile.WriteLine(";"&count&line)        
       
  Analysis.Spectra.Delete Analysis.Spectra.Count ' remove spectrum from compound list   
next        
  
        
form.close() 